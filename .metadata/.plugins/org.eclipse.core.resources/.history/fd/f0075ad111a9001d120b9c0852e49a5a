package ExcelPrograms;

import java.io.File;
import java.io.FileInputStream;

import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;

import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelReader {

	public void readFromFile(String filepath, String filename, String sheetname) throws Throwable {

		// Creating an object of fileclass with full path of the file including name
		File file = new File(filepath + "\\" + filename);

		// Create an object of FileInputStream class to read excel file and pass above
		// file to the input stream
		 
		FileInputStream fileinputstream = new FileInputStream(file);		
		String extensionOfExcelFile = filename.substring(filename.indexOf("."));
		Workbook workbook = null;
		
		
		//Check condition if the file is xlsx file or xls  and accordingly creating workbook		
		if (extensionOfExcelFile.equals(".xls")) {
			 workbook = new HSSFWorkbook(fileinputstream);						
		} else if (extensionOfExcelFile.equals(".xlsx")) {
			 workbook = new XSSFWorkbook(fileinputstream);
		}
		
		Sheet sheet = workbook.getSheet(sheetname);
		
		
		
		
		for (int i = 0;i<sheet.getLastRowNum(); i ++) {
			
			for(int j = 0; j<sheet.getRow(i).getLastCellNum();j++) {
				
				System.out.println(sheet.getRow(i).getCell(j).getStringCellValue() + "  |  ");
				
			}
			
			
			
		}
				
				
		
	
		
		
		
				
				
		
		
		
		
		
	
	}
	
	public static void main(String[] args) {
		
		System.out.println(System.getProperty("user.dir"));
		
		
	}

}
